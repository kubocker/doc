---
title: "月間ナンバーズ3当選データをスクレイピングしてCSV化"
emoji: "📚"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["python"]
published: false
---


ナンバーズ3の当選番号など閲覧できるサイトは数多くあるが
スクレイピングしやすいサイトは[宝くじの楽天サイト](https://takarakuji.rakuten.co.jp/)ではないかと考えている

ナンバーズ3の当選番号など閲覧できるサイトは数多くあるが
スクレイピングしやすいサイトは[宝くじの楽天サイト](https://takarakuji.rakuten.co.jp/)ではないかと考えている

ナンバーズ4でもナンバーズ3でも同じである

## 環境

python 3.8

## セットアップ

```bash
pip install beautifulsoup4
pip install pandas
pip install requests
```

## 手順

- 設定

```python
MONTH = '202102'
URL = 'https://takarakuji.rakuten.co.jp/backnumber/numbers3/{0}/'.format(MONTH)
CSV_FILE = '{起きたいCSVファイルのパス}' + 'numbers3/{0}.csv'.format(MONTH)
```

- アウトプット情報

```python
output = open(CSV_FILE, mode='w')
```

- スクレイピング

```python
scraping = BeautifulSoup(requests.get(URL).content,'html.parser'
```

- HTMLタグ

```python
tag_table = scraping.find_all('table')
```

- テーブル各データ取得

```python
data = []
for _i in range(0, len(tag_table)):
    # 回号
    num = [f for f in tag_table[_i].find_all('th')[1]]
    # 結果
    info = [d.text for d in tag_table[_i].find_all('td')]
    # データへ
    data.append(num + info
```

- CSVへ挿入

```python
for _row in data:
    writer = csv.writer(output)
    writer.writerow(_row)
```

みずほ銀行宝くじの結果が大体19時ごろには更新されるので楽天宝くじサイトでは20時ごろに更新される。20時以降のスクレイピングで最新を取得できるはずである。
